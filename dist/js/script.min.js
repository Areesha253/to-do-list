var tasksURL="includes/tasks.php",getTaskTemplate=t=>` 
    <li class="list-group-item" data-id="${t.id}">
        <div class="checkbox-with-task-text">
            <input type="checkbox" class="status-checkbox action-btn" 
            data-id="${t.id}" 
            ${"completed"===t.status?"checked":""}>
            <span class="task-text">${t.task}</span>
        </div>
        ${"completed"===t.status?'<span class="badge bg-success ms-2">Completed</span>':""}
            <button class="btn btn-sm btn-danger delete action-btn ms-2" data-id="${t.id}">
            <i class="fa-solid fa-trash"></i></button>
    </li>
`,loadTasks=async()=>{if(0!==$("#taskList").length)try{var t=(await $.ajax({url:tasksURL,method:"GET",data:{name:"get_all"}})).map(getTaskTemplate).join("");$("#taskList").html(t)}catch(t){console.error("Error loading tasks:",t),showToastAlert("Failed to load tasks!",{backgroundColor:"red"})}},showToastAlert=(t,a={})=>{Toastify({text:t,duration:a.duration||2e3,gravity:a.gravity||"top",position:a.position||"left",backgroundColor:a.backgroundColor||"green"}).showToast()},disableButtons=t=>{t.find(".action-btn").prop("disabled",!0)},enableButtons=t=>{t.find(".action-btn").prop("disabled",!1)};$("#taskForm").on("submit",async t=>{t.preventDefault();t=$("#taskInput").val().trim();try{await $.ajax({url:tasksURL,method:"POST",data:{task:t}}),loadTasks(),$("#taskInput").val(""),showToastAlert("Task Added Successfully")}catch(t){console.error("Error adding task:",t),showToastAlert("Failed to add task!",{backgroundColor:"red"})}}),$("#taskList").on("click",".status-checkbox",async function(){var t=$(this).closest("li"),a=$(this).attr("data-id");disableButtons(t);try{"completed"===(await $.ajax({url:tasksURL,method:"PATCH",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:a})})).newStatus?showToastAlert("Task Marked as Completed!"):showToastAlert("Task Marked as Not Completed!",{backgroundColor:"orange"}),loadTasks()}catch(t){showToastAlert("Failed to mark task as completed!",{backgroundColor:"red"})}enableButtons(t)}),$("#taskList").on("click",".delete",async function(){var t=$(this).closest("li"),a=$(this).attr("data-id");disableButtons(t);try{await $.ajax({url:tasksURL,method:"DELETE",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:a})}),t.remove(),showToastAlert("Task has been Deleted!",{backgroundColor:"purple"})}catch(t){showToastAlert("Failed to delete task!",{backgroundColor:"red"})}enableButtons(t)}),loadTasks(),$("#user-login-form").on("submit",async function(t){t.preventDefault();var t=$("#username").val(),a=$("#password").val();try{var s=await $.ajax({type:"POST",url:"includes/login.php",data:{username:t,password:a}});"success"===s.status?(showToastAlert("Login successful! Redirecting...",{position:"center"}),setTimeout(()=>{window.location.href="index.php"},2e3)):showToastAlert(s.message,{backgroundColor:"red",position:"center"})}catch(t){console.error("AJAX Error:",t),showToastAlert("An error occurred during login. Please try again.",{backgroundColor:"red"})}}),$(".logout-btn").on("click",function(){window.location.href="includes/logout.php"});