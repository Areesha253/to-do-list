var tasksURL="includes/tasks.php",getTaskTemplate=a=>` 
    <li class="list-group-item" data-id="${a.id}">
        <span class="task-text">${a.task}</span>
        ${"completed"===a.status?'<span class="badge bg-success ms-2">Completed</span>':""}
        <div class="checkbox-with-delete-btn">
        <input type="checkbox" class="status-checkbox action-btn" data-id="${a.id}" 
        ${"completed"===a.status?"checked":""}>
        <i class="fa-solid fa-trash delete-btn action-btn" data-id="${a.id}"></i></div>
    </li>
`,loadTasks=async()=>{if(0!==$("#taskList").length)try{var a=(await $.ajax({url:tasksURL,method:"GET",data:{name:"get_all"}})).map(getTaskTemplate).join("");$("#taskList").html(a)}catch(a){console.error("Error loading tasks:",a),showToastAlert("Failed to load tasks!",{backgroundColor:"red"})}},showToastAlert=(a,t={})=>{Toastify({text:a,duration:t.duration||2e3,gravity:t.gravity||"top",position:t.position||"left",backgroundColor:t.backgroundColor||"green"}).showToast()},disableButtons=a=>{a.find(".action-btn").prop("disabled",!0)},enableButtons=a=>{a.find(".action-btn").prop("disabled",!1)};$("#taskForm").on("submit",async a=>{a.preventDefault();a=$("#taskInput").val().trim();try{await $.ajax({url:tasksURL,method:"POST",data:{task:a}}),loadTasks(),$("#taskInput").val(""),showToastAlert("Task Added Successfully")}catch(a){console.error("Error adding task:",a),showToastAlert("Failed to add task!",{backgroundColor:"red"})}}),$("#taskList").on("click",".status-checkbox",async function(){var a=$(this).closest("li"),t=$(this).attr("data-id");disableButtons(a);try{"completed"===(await $.ajax({url:tasksURL,method:"PATCH",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:t})})).newStatus?showToastAlert("Task Marked as Completed!"):showToastAlert("Task Marked as Not Completed!",{backgroundColor:"orange"}),loadTasks()}catch(a){showToastAlert("Failed to mark task as completed!",{backgroundColor:"red"})}enableButtons(a)}),$("#taskList").on("click",".delete-btn",async function(){var a=$(this).closest("li"),t=$(this).attr("data-id");disableButtons(a);try{await $.ajax({url:tasksURL,method:"DELETE",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:t})}),a.remove(),showToastAlert("Task has been Deleted!",{backgroundColor:"purple"})}catch(a){showToastAlert("Failed to delete task!",{backgroundColor:"red"})}enableButtons(a)}),loadTasks(),$("#user-login-form").on("submit",async function(a){a.preventDefault();var a=$("#username").val(),t=$("#password").val();try{var s=await $.ajax({type:"POST",url:"includes/login_register.php",data:{name:"user_login",username:a,password:t}});"success"===s.status?window.location.href="admin.php":showToastAlert(s.message,{backgroundColor:"red"})}catch(a){console.error("AJAX Error:",a),showToastAlert("An error occurred during login. Please try again.",{backgroundColor:"red"})}}),$("#user-registeration-form").on("submit",async function(a){a.preventDefault();var a=$("#username").val(),t=$("#password").val();try{var s=await $.ajax({type:"POST",url:"includes/login_register.php",data:{name:"user_register",username:a,password:t},dataType:"json"});"success"===s.status?(showToastAlert("Registration successful! Please Login to Continue",{backgroundColor:"green"}),setTimeout(()=>{window.location.href="index.php"},3e3)):showToastAlert(s.message,{backgroundColor:"red"})}catch(a){console.error("AJAX Error:",a),showToastAlert("An error occurred during registration. Please try again.",{backgroundColor:"red"})}});